storage-system-monitoring-for-windows
==========================

*Read this in: [Russian](README.md), [English](README.en.md).*

Добро пожаловать, уважаемый клиент компании FastVPS Eesti OU! :) Вы пришли сюда потому что мы очень заботимся о Вас и сохранности Ваших Данных!

В данном репозитории размещен открытый код используемой нами системы диагностики дисковой подсистемы Ваших серверов. 

Как установить скрипт мониторинга?
- Скачиваем установщик https://github.com/FastVPSEestiOu/storage-system-monitoring-for-windows/releases/latest/download/fastvps_monitoring_install.exe 
- Запускаем его и следуем инструкциям по установке.
- Скачивание и запуск установщика можно выполнить следующей PowerShell командой:
```powershell
wget https://github.com/FastVPSEestiOu/storage-system-monitoring-for-windows/releases/latest/download/fastvps_monitoring_install.exe  -OutFile C:\Users\Administrator\Downloads\fastvps_monitoring_install.exe; & C:\Users\Administrator\Downloads\fastvps_monitoring_install.exe
```

Где посмотреть мануал по использованию скрипта?
 -  Актуальную документацию для Вашей версии скрипта Вы можете получить при помощи стандартной утилиты powershell - Get-Help. Пример команды для запуска в powershell:
 ```powershell
Get-Help C:\FASTVPS\StorageMonitoring\FastvpsMonitoring.ps1 -Full
```

Насколько безопасен скрипт?
- Скрипт работает по шифрованному каналу (https, ssl)
- Скрипт не открывает портов на системе (что исключает вторжение извне)
- Скрипт не обновляется автоматически (что исключение добавление уязвимостей)
- Скрипт имеет полностью открытый код (что дает возможность ознакомиться с его содержимым)

За что отвечают отдельные файоы в данном репозитории?
- FastvpsMonitoring.ps1 - сам скрипт, который собирается информацию по дискам и массивам.
- storage-monitoring-installer.NSI - конфигурационный файл для утилиты NSIS, которой компилируется установщик.
- installer/fastvps_monitoring_install.exe - уже скомплированный утилитой NSIS установщик.
- utilities/arcconf - файлы утилиты arcconf, используемой для работы с контроллерами Adaptec.
- utilities/megacli - файлы утилиты megacli, используемой для работы с контроллерами LSI.
- utilities/smartmontools - файлы утилиты smartctl, используемой для получения данных с физических дисков.

Куда отправляются все данные? 
- Они отправляются по адресу https://fastcheck24.com по шифрованному соединению

Что мы делаем с данными?
- Мы их анализируем специализированным ПО использующим различные алгоритмы для предсказания возможного отказа дисковой подсистемы
- В случае обнаружения деструктивных проблем на дисковой подсистеме мы свяжемся с Вами по всем доступным способам

Какие виды аппаратных RAID поддерживает мониторинг?
- Adaptec
- LSI
- DELL PERC (LSI)

Что делает скрипт мониторинга?
- Ежечасно отправляет информацию по VirtualDisk.
- Ежечасно отправляет информацию по аппаратным RAID-ам и диском подключенным через них. 
- Ежечасно отправяет выдачу smartctl по всем дискам в системе.

Что скрипт НЕ делает?
- Скрипт не запускает никаких сторонних модулей
- Скрипт не обновляется в автоматическом режиме
- Скрипт не отправляет никакой информации кроме того, что перечислено выше

Какие ОС поддерживаются:
- Windws Server 2012 r2
- Корректность работы скрипта на других версиях ОС Windows не проверялась и поэтому не гарантируется.

На каком языке написано ПО для мониторинга?
- PowerShell 4.0 (скрипт мониторинга)
- NSIS (установщик)

Какие изменения в системе мы производим?
- Мы создаем schedule task с именем "FastVPS Monitoring", которая выполняется каждый час.
- Мы размещаем утилиты smartctl, arcconf, megacli, а также скрипт storage_system_fastvps_monitoring.pl в каталоге указанном при установке. По умолчанию это C:\FASTVPS\StorageMonitoring\ 

Кто может использовать данное ПО?
- Любой клиент компании FastVPS Eesti OU

Какое ПО мы устанавливаем на сервер и для чего?
- smartmontools - пакет утилит для получения S.M.A.R.T. информации из устройства
- arcconf/megacli - утилиты от производителей Adaptec и LSI

Могу ли я использовать программу только локально, вручную проверяя состояние массивов?
- Да, разумеется, но при этом Вы лишаетсь возможностей нашей системы по анализу S.M.A.R.T. и прочих метрик, проверяется только состояние массива, также Вы не получаете никаких уведомлений в случае отказа дисков

Возможна ли поддержка XXX YYY?
- Разумеется, патчи приветствуются!                                                                    

Как посмотреть данные, которые собраны в процессе работы скрипта?
 - Для этого Вам необходимо запустить скрипт с ключом -Verbose. Все собранные данные будут выведены на экран.
```powershell
C:\FASTVPS\StorageMonitoring\FastvpsMonitoring.ps1 -Verbose
```

 - Если Вы хотите просто посмотреть всю полученную информацию, но не отправлять ее на сервер мониторинга, то необходимо в дополнение использовать ключ -Test:
 ```powershell
C:\FASTVPS\StorageMonitoring\FastvpsMonitoring.ps1 -Verbose -Test
```

Как самому скомпилировать установщик?
 - Скачиваем архив с файлами, которые будут включены в установщик - https://github.com/FastVPSEestiOu/storage-system-monitoring-for-windows/archive/master.zip
 - Скачиваем утилиту для компиляции установщика в exe формате - http://nsis.sourceforge.net/Download
 - Запускаем утилиту NSIS и в качестве конфигурационного файла указываем - storage-monitoring-installer.NSI
 - Дожидаемся окончания компиляции и проверяем работу установщика.
 
Как удалить скрипт мониторинга?
- Достаточно запустить файл C:\FASTVPS\StorageMonitoring\uninstall.exe . Будут удалены все установленные программы, скрипт и задача из планировщика.
